<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>DS 2 : code</title>

    <link href="/cours_informatique/assets/node_modules/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet">
    <link href="/cours_informatique/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

    <link href="/cours_informatique/assets/stylesheets/main.css" rel="stylesheet">

  </head>
  <body>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            [
              '$', '$'
            ],
            [
              '\\(', '\\)'
            ]
          ]
        },
        svg: {
          fontCache: 'global'
        }
      };

      function goTop() {
        window.scrollTo({top: 0});
      }
      function goBottom() {
        window.scrollTo({top: document.body.scrollHeight});
      }
    </script>
    <script type="text/javascript" id="MathJax-script" src="/cours_informatique/assets/node_modules/mathjax/es5/tex-svg-full.js"></script>

    <header class="border-b-2 border-gray-200 mb-4">
      <div class="max-w-[1200px] mx-auto px-4 relative">
        <div class="min-h-[50px] flex justify-between items-center">
          <a class="mx-2" href="/cours_informatique/">Home</a>
        </div>

        <div class="min-h-[50px] flex justify-center items-center absolute right-0 top-0">
          <a class="mx-2" href="/cours_informatique/about">About</a>
          <button onclick="goTop()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 11.25l-3-3m0 0l-3 3m3-3v7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>

          <button onclick="goBottom()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75l3 3m0 0l3-3m-3 3v-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>
        </div>

      </div>
    </header>

    <main class="max-w-[1200px] mx-auto px-4">
      
<article>

  <h1 class="mb-1">DS 2 : code</h1>
  <div class="mb-4">
    

    
      <div class=" px-4 flex items-center">
        
          <div class="font-bold">Auteur : </div>
        
        <ul class="flex not-prose list-none my-0 last:after:content-['•'] last:after:px-1 mx-0 px-1">
          
            <li class="before:content-['•'] before:px-1">François Brucker</li>
          
        </ul>
      </div>
    
  </div>

  

  <p>Le but de ce DS est de coder un 2048.</p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8  mb-2 mr-8">
<p><strong>Consignes</strong></p>
</div><div class="pl-8 mr-8">
<p><strong>Durée du contrôle</strong> : 3 heures.</p>
<ol>
<li>Faites les questions dans l'ordre</li>
<li>n'inventez pas votre propre structure, suivez celle demandée</li>
<li>rendez sur <a href="hhttps://ametice.univ-amu.fr/mod/assign/view.php?id=350820">Amétice</a> un dossier contenant tout votre code ainsi qu'un fichier texte contenant les numéros des questions auxquelles vous avez répondu</li>
</ol>
</div>
</div>
<p>Vous aurez besoin de la bibliothèque <a href="https://pyglet.readthedocs.io/en/latest/">pyglet</a> pour coder les fenêtres et gérer les évènements claviers (avec la méthode <code class="language-">on_key_press</code>) et souris (avec la méthode <code class="language-">on_mouse_press</code>). Nous n'aurons pas besoin de gérer le temps dans ce DS.</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Toutes les informations nécessaires pour ce DS ont été prises de :</p>
<ul>
<li><a href="https://fr.wikipedia.org/wiki/2048_(jeu_vid%C3%A9o)">la description du jeu sur sa page wikipedia</a></li>
<li><a href="https://play2048.co/">cette implémentation du jeu</a></li>
</ul>
</div>
</div>
<p>Commencez par bien lire la page wikipedia précédente et faites une ou deux partie pour bien comprendre comment fonctionne le jeu.</p>
<h2>Documents à rendre</h2>
<p>Un dossier contenant les divers fichiers python dont vous avez eu besoin. Ce dossier <strong>doit contenir</strong> un fichier <code class="language-">main.py</code> qui contient votre jeu.</p>
<h2>Sujet</h2>
<p>Le projet a été découpé en plusieurs étapes que l'on vous demande de suivre.</p>
<p>Vous indiquerez en commentaire de votre ficher <code class="language-">main.py</code> l'étape à laquelle vous vous êtes arrêté.</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Chaque étape est un jalon du projet et n'est pas triviale. Que cela vous prenne un peu de temps pour le faire est normal.</p>
</div>
</div>
<h2>Étape 1 : le fichier <code class="fichier">main.py</code></h2>
<p>Cette étape va créer l'aire de jeu. À l'exécution du fichier <code class="language-">main.py</code>, vous devez obtenir la fenêtre suivante :</p>
<p><img src="%C3%A9tape-1.png" alt="étape 1"></p>
<p>Les couleurs (au format <a href="https://fr.wikipedia.org/wiki/RVBA">RGBA</a>, le dernier paramètre étant la transparence) sont les suivantes :</p>
<ul>
<li>le fond : <code>(185, 173, 161, 255)</code></li>
<li>les cases : <code>(202, 193, 181, 255)</code></li>
</ul>
<p>Les 16 cases de la grille (une matrice 4x4) sont séparées par des marges de 4% de la taille du fond (32 pixels de marge pour une taille de 800 pixels par exemple).</p>
<p><img src="grille-2.png" alt="grille 2"></p>
<h3><code class="fichier">main.py</code></h3>
<p>Le fichier qui exécutera votre programme est le suivant :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token keyword">import</span> pyglet

<span class="token keyword">from</span> grille <span class="token keyword">import</span> Grille


<span class="token keyword">class</span> <span class="token class-name">DeuxMilleQuaranteHuit</span><span class="token punctuation">(</span>pyglet<span class="token punctuation">.</span>window<span class="token punctuation">.</span>Window<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token number">800</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">,</span> <span class="token string">"2048"</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>grille <span class="token operator">=</span> Grille<span class="token punctuation">(</span><span class="token number">800</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">on_draw</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>grille<span class="token punctuation">.</span>draw<span class="token punctuation">(</span><span class="token punctuation">)</span>


window <span class="token operator">=</span> DeuxMilleQuaranteHuit<span class="token punctuation">(</span><span class="token punctuation">)</span>
pyglet<span class="token punctuation">.</span>app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>Vous modifierez la classe <code class="language-">DeuxMilleQuaranteHuit</code> lorsque vous aurez besoin de gérer les évènements.</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>C'est dans la classe <code class="language-">DeuxMilleQuaranteHuit</code> que vous placerez les fonctions de gestion des évènements comme <code class="language-">on_mouse_press(self, x, y, button, modifiers)</code> à l'étape 2 ou <code class="language-">on_key_press(self, symbol, modifiers)</code> à l'étape 5.</p>
</div>
</div>
<h3>La classe <code class="language-">Grille</code></h3>
<p>Implémentez les classes <code class="language-">Grille</code> et <code class="language-">Carré</code> en respectant le diagramme UML suivant :</p>
<p><img src="grille-1.png" alt="grille 1"></p>
<p>L'attribut <code class="language-">cases</code> de la grille est une matrice de <code class="language-">Carré</code>. La taille de chaque carré est identique et est calculée de telle sorte que la matrice (carrés et bords) remplisse la fenêtre.</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<ul>
<li><a href="https://pyglet.readthedocs.io/en/latest/modules/shapes.html#pyglet.shapes.Rectangle">Classe <code class="language-">pyglet.shapes.Rectangle</code></a></li>
<li><a href="/cours_informatique/cours/coder-et-d%C3%A9velopper/bases-python/structurer-son-code/conteneurs/listes/#matrices">Comment créer une matrice</a></li>
</ul>
</div>
</div>
<h2>Étape 2</h2>
<p>Pour pouvoir manipuler les cases de la grille, nous allons ajouter plusieurs méthodes. On ne pourra tester nos méthodes qu'à la toute fin de l'étape, lorsque l'on utilisera l'évènement qui gère les cliques de souris.</p>
<p>Commençons par pouvoir cliquer sur une case précise.</p>
<h3>Méthode <code class="language-">intérieur(x, y)</code> pour les <code class="language-">Carré</code></h3>
<p>Ajoutez une méthode <code class="language-">intérieur(x, y)</code> à la classe <code class="language-">Carré</code> qui rend :</p>
<ul>
<li><code class="language-">True</code> si le point de coordonnées $(x, y)$ est dans le rectangle,</li>
<li><code class="language-">False</code> sinon.</li>
</ul>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Vous pourrez utiliser les attributs <code class="language-">x</code> <code class="language-">y</code>, <code class="language-">width</code> et <code class="language-">height</code> de la classe <code class="language-">pyglet.shapes.rectangle</code>.</p>
</div>
</div>
<h3>Méthode <code class="language-">intérieur(x, y)</code> pour la <code class="language-">Grille</code></h3>
<p>Ajoutez une méthode <code class="language-">intérieur(x, y)</code> à la classe <code class="language-">Grille</code> qui rend :</p>
<ul>
<li><code class="language-">(i, j)</code> si le point de coordonnées $(x, y)$ est dans le rectangle de la case <code class="language-">cases[i][j]</code>,</li>
<li><code class="language-">None</code> si le point n'est dans aucune case de la matrice <code class="language-">cases</code>.</li>
</ul>
<h3>Cliquer sur une case de la matrice</h3>
<p>Utilisez l'évènement <code class="language-">on_mouse_press(self, x, y, button, modifiers)</code> pour afficher sur le terminal avec la fonction <code class="language-">print</code> :</p>
<ul>
<li>&quot;je suis dans la case de coordonnée i, j&quot; si le point de coordonnée $(x, y)$ est dans <code class="language-">cases[i][j]</code>,</li>
<li>&quot;je ne suis pas dans une case de la matrice&quot; si l'on a pas cliqué sur une case.</li>
</ul>
<h2>Étape 3</h2>
<p>Gestion des valeurs des cases.</p>
<h3>Classe <code class="language-">Case</code></h3>
<p>Implémentez la classe <code class="language-">Case</code> d'UML suivant :</p>
<p><img src="valeur-1.png" alt="valeur 1"></p>
<p>L'attribut valeur peut valoir toutes les puissances de 2, allant de 1 à 2048 et est représenté graphiquement par un label de taille 40. Si la valeur vaut 1, elle n'est pas représentée graphiquement (c'est la case vide).</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<ul>
<li><a href="https://pyglet.readthedocs.io/en/latest/modules/text/index.html#pyglet.text.Label">Classe <code class="language-">pyglet.text.Label</code></a></li>
<li>Les couleurs des cases pour les différentes valeurs :
<ul>
<li><code class="language-">(202, 193, 181, 255)</code> pour une valeur de 1</li>
<li><code class="language-">(238, 228, 218, 255)</code> pour une valeur de 2</li>
<li><code class="language-">(237, 224, 200, 255)</code> pour une valeur de 4</li>
<li><code class="language-">(242, 177, 121, 255)</code> pour une valeur de 8</li>
<li><code class="language-">(245, 149, 99, 255)</code> pour une valeur de 16</li>
<li><code class="language-">(246, 124, 95, 255)</code> pour une valeur de 32</li>
<li><code class="language-">(246, 94, 59, 255)</code> pour une valeur de 64</li>
<li><code class="language-">(237, 207, 114, 255)</code> pour une valeur de 128</li>
<li><code class="language-">(237, 204, 97, 255)</code> pour une valeur de 256</li>
<li><code class="language-">(237, 200, 80, 255</code> pour une valeur de 512</li>
<li><code class="language-">(237, 197, 63, 255)</code> pour une valeur de 1024</li>
<li><code class="language-">(237, 194, 46, 255)</code> pour une valeur de 2048</li>
</ul>
</li>
</ul>
</div>
</div>
<h3>Design pattern factory</h3>
<p>Lors de la création de la classe <code class="language-">Grille</code> on utilise des maintenant des objets de type <code class="language-">Case</code> de valeur 1 et non plus des <code class="language-">Carré</code>. Pour que ce soit facile à faire, faite un design pattern factory pour créer des objets de valeur 1. La signature de ce factory doit être :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python">vide<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> taille<span class="token punctuation">)</span>
</code></pre>
<h3>Vérification</h3>
<p>Lors de la création de la fenêtre, modifiez la case de la ligne d'indice 2 et de colonne 1 de la matrice pour que ce soit un objet de la classe <code class="language-">Case</code> de valeur 512 (vous pourrez tester plusieurs valeurs pour vérifier que tout fonctionne)</p>
<h2>Étape 4</h2>
<p>Nous allons préparer la modification dynamique des cases en utilisant l'évènement <code class="language-">on_mouse_press(self, x, y, button, modifiers)</code>.</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Cette étape n'est pas utile pour le jeu en lui-même, mais la coder vous aidera à avancer. Conservez cette partie même si vous allez plus loin.</p>
</div>
</div>
<h3>Méthode <code class="language-">set_valeur(v)</code> de la classe <code class="language-">Case</code></h3>
<p>Le jeu du 2048 passe son temps à modifier les valeurs des cases. Implémentez une une méthode <code class="language-">set_valeur(v)</code> à la classe <code class="language-">Case</code> dont la fonction est de modifier la valeur de la case puis de changer son fond et son label en conséquence.</p>
<p>Utilisez cette méthode dans le constructeur de <code class="language-">Case</code>.</p>
<h3>Méthodes <code class="language-">incrémente()</code> et <code class="language-">décrémente()</code> de la classe <code class="language-">Case</code></h3>
<p>Ajoutez les méthodes <code class="language-">incrémente()</code> et <code class="language-">décrémente()</code> à la classe <code class="language-">Case</code> dont le rôle est de modifier la valeur de la case en l'augmentant (on multiplie la valeur par 2 si elle ne vaut pas 2048) ou la diminuant (on divise la valeur par 2 si elle ne vaut pas 1).</p>
<h3>Cliques gauche et clique droit</h3>
<p>Modifiez la gestion du clique de souris pour que :</p>
<ul>
<li>le clique gauche augmente la valeur de la case sur laquelle on clique</li>
<li>le clique droit diminue la valeur de la case sur laquelle on clique</li>
</ul>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Si vous avez un mac, vous pouvez soit simuler le clique droit soit l'activer en suivant <a href="https://support.apple.com/fr-fr/guide/mac-help/mh35853/mac">cette aide d'apple</a>.</p>
</div>
</div>
<h2>Étape 5</h2>
<p>Tout est en place pour implémenter la mécanique de jeu.</p>
<p>Lorsque l'on appuie sur une flèche de direction, les cases de valeurs strictement plus grandes que 1 se déplacent, une à une, dans le sens de la flèche. L'ordre dans lequel les cases se déplacent est important :</p>
<ul>
<li>lorsque l'on appuie sur la flèche de droite, pour chaque ligne, on déplace les cases en commençant par celle le plus à droite</li>
<li>lorsque l'on appuie sur la flèche de gauche, pour chaque ligne, on déplace les cases en commençant par celle le plus à gauche</li>
<li>lorsque l'on appuie sur la flèche du bas, pour chaque colonne, on déplace les cases en commençant par celle la plus basse</li>
<li>lorsque l'on appuie sur la flèche du haut, pour chaque colonne, on déplace les cases en commençant par celle la plus haute</li>
</ul>
<p>Une case ne peut se déplacer que si la case vers la quelle elle se déplace est vide (de valeur 1) ou de même valeur qu'elle même.</p>
<h3>Déplacement vers une case adjacente</h3>
<p>Commencez par gérer le déplacement vers une case <strong>adjacente</strong> dans la direction souhaitée en utilisant l'évènement <code class="language-">on_key_press(self, symbol, modifiers)</code>.</p>
<p>Vous tenterez de déplacer toutes les cases, une à une dans le bon ordre, <strong>d'une seule case</strong> dans la direction souhaitée. Par exemple si la matrice contient les valeurs suivante :</p>
<pre><code>2114
2221
1111
1141
</code></pre>
<p>L'appui sur une touche de direction produira les matrices ci-dessous :</p>
<pre><code>                4224
                1111
                1141
                1111

                 ^
                haut

2141            2114            1214
4211  &lt; gauche  2221  droite &gt;  1222
1111            1111            1111
1411            1141            1114

                bas
                 v

                1111
                2114
                2221
                1111
</code></pre>
<p>Toutes les cases de valeurs strictement plus grandes que 1 se sont déplacés si possible, soit vers une case libre adjacente soit vers une case de même valeur et ont fusionné.</p>
<h3>Ajout d'une nouvelle case</h3>
<p>Si l'appui sur une touche de direction a effectivement déplacé une case de valeur strictement plus grande que 1, une case de valeur 1 est choisie aléatoirement puis :</p>
<ul>
<li>80% du temps elle est incrémentée une fois (ce qui est equivalent à ajouter une case de valeur 2)</li>
<li>20% du temps elle est incrémentée deux fois (ce qui est equivalent à ajouter une case de valeur 4)</li>
</ul>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Vous pourrez utiliser les méthodes suivantes <a href="https://docs.python.org/fr/3/library/random.html">du module random de python</a></p>
<ul>
<li><a href="https://docs.python.org/fr/3/library/random.html#random.choice"><code class="language-">choice</code></a> pour prendre un élément au hasard parmi la liste des cases de valeur 1</li>
<li><a href="https://docs.python.org/fr/3/library/random.html#random.random"><code class="language-">random</code></a> pour gérer les probabilités.</li>
</ul>
</div>
</div>
<h2>Étape 6</h2>
<p>Déplacement complet.</p>
<h3>Déplacement de plusieurs cases</h3>
<p>Les cases peuvent se déplacer de plusieurs cases vides, si possible. La façon la plus simple de réaliser cette opération est d'effectuer l'opération de déplacement précédente (déplacements vers une case adjacente) 3 fois de suite.</p>
<h3>Nombre d'incrémentations</h3>
<p>Une même case ne peut s'incrémenter qu'une seule fois par déplacement. Par exemple un déplacement vers la droite de la ligne : <code>1224</code> donne <code>1144</code> et non pas <code>1118</code>.</p>
<p>Gérer cette règle.</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Vous pourrez faire cela en ajoutant un attribut à la classe <code class="language-">Case</code>. Cet attribut est faux avant chaque déplacement et devient vrai après un incrément.</p>
<p>Une case ne peut fusionner qu'avec une case de même valeur et dont ce nouvel attribut est faux.</p>
</div>
</div>
<h2>Étape 7</h2>
<p>Détectez après un déplacement si la partie est terminée et affichez à sur le terminal avec la fonction <code class="language-">print</code> si le jeu est fini.</p>


</article>
    </main>

    <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
      <div class="max-w-[1200px] mx-auto px-4 relative">
        <div class="min-h-[50px] flex justify-center items-center">
          <p>
            Cours d'informatique à l'école centrale Marseille
          </p>
        </div>
        <div class="min-h-[50px] flex justify-center items-center absolute right-0 top-0">
          <button onclick="goTop()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 11.25l-3-3m0 0l-3 3m3-3v7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>

          <button onclick="goBottom()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75l3 3m0 0l3-3m-3 3v-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>
        </div>

      </div>
    </footer>

    <script>
      MathJax
        .startup
        .document
        .getMathItemsWithin(document.body);
    </script>

  </body>
</html>