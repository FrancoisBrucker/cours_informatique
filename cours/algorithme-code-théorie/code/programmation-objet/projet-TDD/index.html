<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <title>Projet : TDD</title>

    <link href=/cours_informatique/assets/node_modules/prismjs/themes/prism-solarizedlight.min.css rel="stylesheet">
    <link href=/cours_informatique/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css rel="stylesheet">

    <link href=/cours_informatique/assets/stylesheets/main.css rel="stylesheet">

  </head>
  <body>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            [
              '$', '$'
            ],
            [
              '\\(', '\\)'
            ]
          ]
        },
        svg: {
          fontCache: 'global'
        }
      };

      function goTop() {
        window.scrollTo({top: 0});
      }
      function goBottom() {
        window.scrollTo({top: document.body.scrollHeight});
      }
    </script>
    <script type="text/javascript" id="MathJax-script" 
  src=/cours_informatique/assets/node_modules/mathjax/es5/tex-svg-full.js></script>

    <header class="border-b-2 border-gray-200 mb-4">
      <div class="max-w-[1200px] mx-auto px-4 relative">
        <div class="min-h-[50px] flex justify-between items-center">
          <a class="mx-2" href="/cours_informatique/">Home</a>
        </div>

        <div class="min-h-[50px] flex justify-center items-center absolute right-0 top-0">
          <a class="mx-2" href="/cours_informatique/about">About</a>
          <button onclick="goTop()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 11.25l-3-3m0 0l-3 3m3-3v7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
          </button>

          <button onclick="goBottom()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75l3 3m0 0l3-3m-3 3v-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
          </button>
        </div>

      </div>
    </header>

    <main class="max-w-[1200px] mx-auto px-4">
      
<article>

  <h1  >Projet : TDD</h1>
  <div >
    

    
  </div>

  

    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z" />
</svg>
<div class="pl-8 mr-8">

<a href="/cours_informatique/cours/">Cours</a><span class="px-1">/</span><a href="/cours_informatique/cours/algorithme-code-théorie/">Algorithme, code et théorie</a><span class="px-1">/</span><a href="/cours_informatique/cours/algorithme-code-théorie/code/">Code</a><span class="px-1">/</span><a href="/cours_informatique/cours/algorithme-code-théorie/code/programmation-objet/">Programmation Objet</a><span class="px-1">/</span><a href="/cours_informatique/cours/algorithme-code-théorie/code/programmation-objet/projet-TDD/">Projet : TDD</a>

</div>
</div>

  

  
    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-pink-500 bg-pink-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-pink-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
</svg>
<div class="pl-8  mb-2 mr-8">

<b>Prérequis :</b>

</div><div class="pl-8 mr-8">


    <ul>
            
            <li>
              <a href='/cours_informatique/cours/algorithme-code-théorie/code/programmation-objet/projet-héritage/'>Projet : héritage</a>
            </li></ul>
    

</div>
</div>

  

  <!-- début résumé -->
<p>Nous allons dans cette séance suivre ici le livre <a href="https://www.amazon.fr/Test-Driven-Development-Kent-Beck/dp/0321146530/ref=sr_1_1?ie=UTF8&amp;qid=1538720480&amp;sr=8-1&amp;keywords=test+driven+development+by+example">TDD by example</a> de Kent Beck (Suivez son <a href="https://twitter.com/kentbeck">twitter</a>, ses posts sont souvent rigolos et toujours utiles).</p>
<p>Initialement écrit pour le java, nous allons appliquer ses enseignements au python.</p>
<!-- end résumé -->
<p>En suivant le déroulé du livre <a href="https://www.amazon.fr/Test-Driven-Development-Kent-Beck/dp/0321146530/ref=sr_1_1?ie=UTF8&amp;qid=1538720480&amp;sr=8-1&amp;keywords=test+driven+development+by+example">TDD by example</a>, vous allez apprendre à écrire du code par les tests.<br>
Vous allez y apprendre la pratique d'un bon code :</p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
<div class="pl-8  mb-2 mr-8">
<p>But de la programmation :</p>
</div><div class="pl-8 mr-8">
<p>Créer du code <strong>propre</strong> qui <strong>fonctionne</strong></p>
<p>(<em>clean code that works</em> en version originale)</p>
</div>
</div>
<p>Outre la méthode, nous verrons également quelques techniques pour y arriver de façon claire et pratique, comme des règles de refactoring (issues de <a href="https://www.amazon.fr/Refactoring-Improving-Design-Existing-Code/dp/0201485672/ref=sr_1_2?ie=UTF8&amp;qid=1539066441&amp;sr=8-2">Refactoring: Improving the Design of Existing Code</a> de <a href="https://martinfowler.com">Martin Fowler</a> (allez voir son site, y'a moult choses chouettes sur le code, l'agile, la vie et le reste)).</p>
<p>Ceci devrait vous permettre de diminuer le nombre de WTFs/minute, qui est le meilleur indicateur au monde d'un bon code (issu du livre <a href="https://www.amazon.fr/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882">clean code</a> de <a href="https://fr.wikipedia.org/wiki/Robert_C._Martin">Robert C. Martin</a>. Ce n'est pas un livre pour débutant mais si vous avez déjà compris le tdd, c'est un super pour finaliser votre compréhension) :</p>
<p><img src="wtfm.jpg" alt="WTFs/minute"></p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
<div class="pl-8 mr-8">
<p>Faites l'effort de suivre cette séance en codant <strong>en même temps</strong> le projet. Tout est donné mais le voir fonctionner pour de vrai est plus impressionnant que de juste le lire.</p>
</div>
</div>
<p>On va exécuter les tests un million de fois. Pour éviter la luxation de l'index il faut retenir les raccourcis claviers qui vont vous permettre de lancer les tests sans problème :</p>
<ul>
<li>dédiez un terminal pour cela. Une fois la commande tapée, il vous suffit de faire <em>flèche du haut</em> pour revenir à la commande précédente et l'exécuter</li>
<li>lorsque vos tests passent, il est intéressant d'utiliser le raccourci clavier de votre éditeur pour exécuter tous les tests (sous <a href="https://docs.microsoft.com/fr-fr/visualstudio/ide/default-keyboard-shortcuts-in-visual-studio?view=vs-2022#bkmk_test-global-shortcuts">vscode</a>).</li>
</ul>
<h2>Projet</h2>
<p>Vous allez créer dans cette séance une application de change entre Franc suisse (CHF) et dollars US ($).</p>
<table>
<thead>
<tr>
<th>qui</th>
<th>combien</th>
<th>prix</th>
<th>total</th>
</tr>
</thead>
<tbody>
<tr>
<td>Apple</td>
<td>1000</td>
<td>$200</td>
<td>$200 000</td>
</tr>
<tr>
<td>Nestlé</td>
<td>400</td>
<td>80 CHF</td>
<td>32 000 CHF</td>
</tr>
<tr>
<td colspan="3"><strong>total</strong></td>
<td><strong>$248 000</strong></td>
</tr>
</tbody>
</table>
<p>Avec le taux de conversion : 1 CHF = $0.5</p>
<h3>Comment ?</h3>
<p>En programmant par les tests bien sur !</p>
<p>On commence par une todo list qui regroupe tout ce que l'on pense faire pour l'instant. Cette liste va diminuer lorsque l'on avancera sur le projet et grossir lorsque notre connaissance du projet va s'affiner.</p>
<p>Nous n'utiliserons pas ici notre code. Mais il faudra tout faire <em>from scratch</em>. On aura donc besoin :</p>
<ul>
<li>d'une todo list où tous nos items à faire pour l'instant sont écrit : le <em>backlog</em></li>
<li>de fichiers de tests</li>
<li>du code</li>
</ul>
<p>On verra tout au long du cours divers patterns de test et de développement pour que tout aille pour le mieux. Notre but est ici de faire du :</p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
<div class="pl-8 mr-8">
<p><em>clean code that works</em></p>
</div>
</div>
<p>Pour cela on va se fixer quelques règles :</p>
<ul>
<li>on écrit du code que si un test rate</li>
<li>on élimine les duplications</li>
</ul>
<p>Ces 2 règles impliquent un mode de fonctionnement de note production code :</p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
<div class="pl-8  mb-2 mr-8">
<p><strong>Principe du TDD</strong></p>
</div><div class="pl-8 mr-8">
<ol>
<li><strong>rouge</strong> :
<ul>
<li>écrire <em>rapidement</em> un <em>petit</em> test</li>
<li>lancer les tests et les voir planter, voir même  ne correspondre à aucun code.</li>
</ul>
</li>
<li><strong>vert</strong> :
<ul>
<li>écrire le code <em>minimal</em> qui permet de faire passer le test</li>
<li>lancer les tests et les voir tous réussir</li>
</ul>
</li>
<li><strong>code/refactor</strong> :
<ul>
<li>élimine les duplications tout en conservant la validité des tests.</li>
</ul>
</li>
</ol>
<p>La partie refactor, qui est la partie réelle où l'on code ne se fait <strong>que sur du vert</strong> : on est assuré de ne pas casser le code puisque les tests passent.</p>
</div>
</div>
<p>Cela permet de prendre du plaisir à coder :</p>
<ul>
<li>en écrivant du code dont est sûr qu'il ne cassera rien</li>
<li>en voyant la todo list diminuer ce qui montre qu'on progresse</li>
<li>comme tous les tests sont conservés on sait que l'on ne travaille pas pour rien</li>
</ul>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
<div class="pl-8 mr-8">
<p>Toutes ces règles visent à diminuer la peur qui bloque tout progrès</p>
</div>
</div>
<h3>Code</h3>
<p>On va développer petit à petit notre propre application de change en utilisant le TDD. La logique est :</p>
<ul>
<li>chaque test couvre un petit ajout d'une fonctionnalité</li>
<li>la première chose à faire sera de (rapidement et salement) faire fonctionner les tests</li>
<li>toute les modifications de code sont effectuées alors que les testent passent</li>
<li>le refactoring est fait par petites touches</li>
</ul>
<h2>Déroulé</h2>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-yellow-500 bg-yellow-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-yellow-500" xmlns="http://www.w3.org/2000/svg"  fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
</svg>
<div class="pl-8 mr-8">
<p>Créez un dossier <code class="fichier">projet-tdd</code> qui contiendra votre projet.</p>
</div>
</div>
<p>Le déroulé du projet est séparé en trois parties :</p>
<ol>
<li><a href="projet-tdd-1">projet : TDD 1/3</a> (introduction et principes de la méthode en action)</li>
<li><a href="projet-tdd-2">projet : TDD 2/3</a> (on s'entraîne)</li>
<li><a href="projet-tdd-3">projet : TDD 3/3</a> (on progresse en utilisant des design pattern)</li>
</ol>
<h2>Bilan</h2>
<p>Cette méthode vous aidera à mieux coder, elle élimine la peur de faire des essais et de modifier le code. En revanche, elle n'est vraiment efficace qu'une fois bien assimilée. Avant, vous allez avoir l'impression de perdre votre temps.</p>
<p>Faire l'effort de maîtriser la technique, les effets vous seront bénéfique tout au long de votre vie de code.</p>


</article>
    </main>

    <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
      <div class="max-w-[1200px] mx-auto px-4 relative">
        <div class="min-h-[50px] flex justify-center items-center">
          <p>
            Cours d'informatique à l'école centrale Marseille
          </p>
        </div>
        <div class="min-h-[50px] flex justify-center items-center absolute right-0 top-0">
          <button onclick="goTop()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 11.25l-3-3m0 0l-3 3m3-3v7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
          </button>

          <button onclick="goBottom()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75l3 3m0 0l3-3m-3 3v-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
          </button>
        </div>

      </div>
    </footer>

    <script>
      MathJax
        .startup
        .document
        .getMathItemsWithin(document.body);
    </script>

  </body>
</html>