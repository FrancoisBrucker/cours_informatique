<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Structure d&#39;un fichier</title>

    <link href="/cours_informatique/assets/node_modules/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet">
    <link href="/cours_informatique/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

    <link href="/cours_informatique/assets/stylesheets/main.css" rel="stylesheet">

  </head>
  <body>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            [
              '$', '$'
            ],
            [
              '\\(', '\\)'
            ]
          ]
        },
        svg: {
          fontCache: 'global'
        }
      };

      function goTop() {
        window.scrollTo({top: 0});
      }
      function goBottom() {
        window.scrollTo({top: document.body.scrollHeight});
      }
    </script>
    <script type="text/javascript" id="MathJax-script" src="/cours_informatique/assets/node_modules/mathjax/es5/tex-svg-full.js"></script>

    <header class="border-b-2 border-gray-200 mb-4">
      <div class="max-w-[1200px] mx-auto px-4 relative">
        <div class="min-h-[50px] flex justify-between items-center">
          <a class="mx-2" href="/cours_informatique/">Home</a>
        </div>

        <div class="min-h-[50px] flex justify-center items-center absolute right-0 top-0">
          <a class="mx-2" href="/cours_informatique/about">About</a>
          <button onclick="goTop()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 11.25l-3-3m0 0l-3 3m3-3v7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>

          <button onclick="goBottom()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75l3 3m0 0l3-3m-3 3v-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>
        </div>

      </div>
    </header>

    <main class="max-w-[1200px] mx-auto px-4">
      
<article>

  <h1>Structure d&#39;un fichier</h1>
  <div>
    

    
  </div>

  

    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">

<a class="interne" href="/cours_informatique/cours/">Cours</a><span class="px-1">/</span><a class="interne" href="/cours_informatique/cours/algorithme-code-théorie/">Algorithme, code et théorie</a><span class="px-1">/</span><a class="interne" href="/cours_informatique/cours/algorithme-code-théorie/code/">Code</a><span class="px-1">/</span><a class="interne" href="/cours_informatique/cours/algorithme-code-théorie/code/fichiers/">Fichiers</a><span class="px-1">/</span><a class="interne" href="/cours_informatique/cours/algorithme-code-théorie/code/fichiers/structure/">Structure d&#39;un fichier</a>

</div>
</div>


    
  

  <!-- début résumé -->
<p>Stocker des données est une préoccupation depuis les origines de l'informatique : d'abord sur cartes perforées, puis sur bandes magnétiques et jusqu'aux disques durs et clés actuelles. Un <a href="https://fr.wikipedia.org/wiki/Fichier_informatique">fichier</a> est ainsi un ensemble de données que l'on peut lire ou écrire pour les sauvegarder. Nous n'entrerons cependant pas dans les détails des <a href="https://fr.wikipedia.org/wiki/Syst%C3%A8me_de_fichiers">systèmes de fichiers</a> (comment sont effectivement stockés les fichiers sur le disque dur), car c'est une affaire (très) compliquée. Nous n'aborderons que le strict nécessaire pour les manipuler en python.</p>
<!-- end résumé -->
<p>Toutes les manipulations spécifiques des fichiers (buffer, impossibilité de modifier, etc) sont issues des origines de l'informatique où stocker et charger des données était une chose compliquée <em>physiquement</em> (voir par exemple le <a href="https://youtu.be/HQyckYYT3_8?t=1120">chargement d'un programme depuis une cassette sur un TO7</a> qui prenait plus d'un quart d'heure... Et c'est du vécu, le TO7 a été ma première machine)</p>
<h2>Système de fichiers</h2>
<p>Un fichier est constitué d'une suite de blocs sur le disque dur, chaque bloc ayant une adresse contenant le bloc suivant. C'est une <a href="https://fr.wikipedia.org/wiki/Liste_cha%C3%AEn%C3%A9e">liste chaînée</a> de tableaux de même taille contenant les données (des octets).</p>
<p>Ce format a été choisi parce que :</p>
<ul>
<li>des fichiers de tailles différentes doivent pouvoir être ajoutés et supprimés du disque dur. La place y est donc <a href="https://fr.wikipedia.org/wiki/D%C3%A9fragmentation_(informatique)">fragmentée</a>, et il n'est pas sûr de pouvoir avoir la taille requise pour un fichier.</li>
<li>on doit pouvoir ajouter des choses à un fichier sans avoir à tout re-écrire</li>
</ul>
<p>Les limitations sont donc :</p>
<ul>
<li>on accède au fichier petit à petit. Il faut une <em>tête de lecture</em> qui voyage de bloc en bloc.</li>
<li>il est impossible d'insérer des choses dans un fichier. On peut juste ajouter des éléments à la fin de celui-ci.</li>
<li>le système de fichier dépend du système d'exploitation.</li>
<li>écrire/lire sur un disque est coûteux en temps. Il est nécessaire d'avoir une <a href="https://fr.wikipedia.org/wiki/M%C3%A9moire_tampon">mémoire tampon</a> ce qui rend asynchrone la lecture et l'écriture d'un fichier.</li>
</ul>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Ce qu'on peut faire avec un fichier :</p>
<ul>
<li><strong>ouvrir</strong> le fichier : c'est se préparer à l'utiliser. Cette étape  crée un <em>buffer</em> (mémoire tampon), un pointeur de bloc, une tête de lecture, etc.</li>
<li><strong>fermer</strong> un fichier : arrêter de s'en servir. Il est <strong>indispensable</strong> de toujours fermer un fichier après s'en être servi. On écrit en effet à cette étape les dernières instructions non encore passées du <em>buffer</em> au disque dur (c'est comme démonter une clé USB proprement).</li>
<li><strong>lire</strong> un fichier : on fait avancer la <em>tête de lecture</em> du fichier, d'une ligne ou d'un nombre donné d'octets</li>
<li><strong>écrire</strong> un fichier : on ajoute des données à la fin d'un fichier (qui peut être initialement vide). Souvent on écrit pas tout de suite sur le disque dur, on attend d'avoir un nombre suffisant de données dans la mémoire tampon.</li>
</ul>
</div>
</div>
<p>Au niveau de l'ordinateur, utiliser un fichier, c'est compliqué.</p>
<h2>Types de fichiers</h2>
<p>On a coutume de séparer les fichiers en deux grandes familles : les <a href="https://fr.wikipedia.org/wiki/Fichier_texte">fichiers texte</a> et les <a href="https://fr.wikipedia.org/wiki/Fichier_binaire">fichiers binaires</a>. Cette séparation, essentiellement historique, est un peu artificielle mais vous trouverez encore souvent cette distinction :</p>
<ul>
<li>Les fichiers binaires sont les plus nombreux puisque c'est presque tous les fichiers : les images, vidéos, programmes, etc. Il faut un  outil spécial pour les utiliser, c'est à dire un moyen de passer de l'octet à sa signification. On peut aider l'utilisateur en mettant une extension à son nom correspondant au type de fichier, mais ce n'est pas obligatoire.</li>
<li>Les fichiers textes sont eux aussi constitués de nombres (un ordinateur ne connaît que ça), mais on peut leur faire correspondre des caractères via un code (voir partie format).</li>
</ul>
<p>Passer des octets à leurs significations pour un fichier se fait via un <a href="https://fr.wikipedia.org/wiki/Codec">codec</a> (codeur/décodeur). Il y en a pour les fichiers binaires le codec MPEG4 par exemple, mais aussi pour les fichiers texte même si dans ce cas là on parlera plutôt d'encodage (comme utf-8).</p>
<h2>Voir un fichier</h2>
<p>Savoir comment interpréter les données d'un fichier n'est pas une chose facile. L'<a href="https://fr.wikipedia.org/wiki/Extension_de_nom_de_fichier">extension</a> permet au système d'exploitation d'associer une application spécifique (un visualiseur d'image si le fichier fini par <em>&quot;.jpg&quot;</em> par exemple). Mais ce n'est qu'une indication. Un fichier python ne se transforme pas par magie en image si on ajoute une extension <em>&quot;.jpg&quot;</em> au fichier...</p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Utilisez <strong>toujours</strong> une extension à vos fichiers. Cela permet de gagner beaucoup de temps pour ouvrir directement la bonne application pour lire votre fichier.</p>
</div>
</div>
<p>Sans extension ou sans idée de ce que contient un fichier, ce n'est qu'une suite d'octets. Pour s'en rendre compte :</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-yellow-500 bg-yellow-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-yellow-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Installez l'extension <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.hexeditor">Hex Editor</a> pour vscode.</p>
<p>Vous pourrez la trouver dans le menu <em>menu Affichage &gt; extension</em> puis recherchez <strong>Hex Editor</strong> dans la barre de recherche pour l'installer.</p>
</div>
</div>
<p>Cette extension permet d'ouvrir tout fichier comme la suite d'octet qu'il est réellement. Pour cela :</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-yellow-500 bg-yellow-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-yellow-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
</svg>
<div class="pl-8 mr-8">
<ol>
<li>ouvrez une nouvelle fenêtre avec vscode : <em>menu Fichier &gt; nouvelle fenêtre</em></li>
<li>dans cette nouvelle fenêtre : <em>menu Affichage &gt; explorateur</em> puis cliquez sur <em>open folder</em> pour choisir un dossier contenant des images, des pdf et d'autres types de fichiers (souvent le dossier téléchargement est un bon candidat)</li>
<li>cliquez droit sur un fichier et choisissez <em>ouvrir avec...</em><br>
<img src="fichiers-ouvrir-avec.png" alt="ouvrir avec"></li>
<li>choisissez &quot;Hex editor&quot;<br>
<img src="fichiers-hex-editor.png" alt="hex editor"></li>
<li>on obtient quelque chose en 3 parties : les octets, l'interprétation ASCII de chaque octet et des informations :<br>
<img src="fichiers-panel.png" alt="panel"></li>
</ol>
</div>
</div>
<p>Certains types de fichiers sont reconnaissables par leurs premiers octets. On appelle ça des <a href="https://en.wikipedia.org/wiki/List_of_file_signatures"><em>magic number</em> ou des <em>signatures</em></a>. Si vous ouvrez un fichier pdf par exemple, vous remarquerez qu'il commence par les caractères ASCII : <code>%PDF-</code>. Mais ce n'est pas la norme. Donc pour vous éviter des soucis, pensez à bien utiliser les extensions de fichier pour aider votre système d'exploitation à trouver la bonne application à ouvrir.</p>


</article>
    </main>

    <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
      <div class="max-w-[1200px] mx-auto px-4 relative">
        <div class="min-h-[50px] flex justify-center items-center">
          <p>
            Cours d'informatique à l'école centrale Marseille
          </p>
        </div>
        <div class="min-h-[50px] flex justify-center items-center absolute right-0 top-0">
          <button onclick="goTop()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 11.25l-3-3m0 0l-3 3m3-3v7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>

          <button onclick="goBottom()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75l3 3m0 0l3-3m-3 3v-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>
        </div>

      </div>
    </footer>

    <script>
      MathJax
        .startup
        .document
        .getMathItemsWithin(document.body);
    </script>

  </body>
</html>