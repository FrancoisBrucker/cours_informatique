<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Système de fichiers</title>

    

    <link href="https://prismjs.catppuccin.com/latte.css" rel="stylesheet">

    <link href="/cours_informatique/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">
    <script src="/cours_informatique/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script>
    
    <link href="/cours_informatique/assets/stylesheets/main.css" rel="stylesheet">

  </head>
  <body>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            [
              '$', '$'
            ],
            [
              '\\(', '\\)'
            ]
          ]
        },
        svg: {
          fontCache: 'global'
        }
      };

      function goTop() {
        window.scrollTo({top: 0});
      }
      function goBottom() {
        window.scrollTo({top: document.body.scrollHeight});
      }
    </script>
    <script type="text/javascript" id="MathJax-script" src="/cours_informatique/assets/node_modules/mathjax/es5/tex-svg-full.js"></script>

    <header class="border-b-2 border-gray-200 mb-4">
      <div class="max-w-[1200px] mx-auto px-4 relative">
        <div class="min-h-[50px] flex justify-between items-center">
          <a class="mx-2" href="/cours_informatique/">Home</a>
        </div>

        <div class="min-h-[50px] flex justify-center items-center absolute right-0 top-0">
          <a class="mx-2" href="/cours_informatique/about">About</a>
          <button onclick="goTop()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 11.25l-3-3m0 0l-3 3m3-3v7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>

          <button onclick="goBottom()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75l3 3m0 0l3-3m-3 3v-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>
        </div>

      </div>
    </header>

    <main class="max-w-[1200px] mx-auto px-4">
      
<article>

  <h1>Système de fichiers</h1>
  <div>
    

    
  </div>

  

    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">

<a class="interne" href="/cours_informatique/cours/">Cours</a><span class="px-1">/</span><a class="interne" href="/cours_informatique/cours/système-et-réseau/">Système et réseau</a><span class="px-1">/</span><a class="interne" href="/cours_informatique/cours/système-et-réseau/système-exploitation/">Système d&#39;exploitation</a><span class="px-1">/</span><a class="interne" href="/cours_informatique/cours/système-et-réseau/système-exploitation/système-fichiers/">Système de fichiers</a>

</div></div>



    
  

  <blockquote>
<p>TBD : journalisation : faire des dessins.</p>
</blockquote>
<p>Un système de fichiers est une structure permettant de stocker de l'information sur un disque dur. Un système a donc habituellement plusieurs systèmes de fichiers : un pour chaque disque dur et un pour chaque clé usb insérée.</p>
<p>Il est possible d'avoir plusieurs systèmes de fichier par disque dur en le <a href="https://fr.wikipedia.org/wiki/Partition_(informatique)">partitionnant</a>.</p>
<p>Un <a href="/cours_informatique/tutoriels/fichiers-navigation">système de fichier</a> est organisé en arbre :</p>
<ul>
<li>chaque nœud est appelé dossier (ou répertoire, <em>directory</em> en anglais)</li>
<li>chaque nœud possède toujours au moins deux enfants :
<ul>
<li><code class="fichier">'.'</code> qui représente lui-même</li>
<li><code class="fichier">'..'</code> qui représente son parent</li>
</ul>
</li>
<li>les fichiers sont les feuilles de l'arbre, ce sont eux qui contiennent l'informations stockée</li>
</ul>
<p>Les dossiers et les fichiers possèdent des meta-données qui les spécifient :</p>
<ul>
<li>leur nom</li>
<li>leur propriétaire et leur groupe d'appartenance</li>
<li>leurs permissions (lire/écrire et exécuter) pour leur propriétaire, leur groupe et le reste des utilisateurs</li>
<li>la dernière fois qu'ils ont été utilisé</li>
<li>la date de leur création</li>
<li>...</li>
</ul>
<h2>Utilisation d'un système de fichier</h2>
<p>Opérations que l'on peut faire sur les fichiers, selon les permissions :</p>
<ul>
<li>créer / supprimer : dépend des droits du dossier parent</li>
<li>ouvrir / fermer / seek</li>
<li>lire en seek</li>
<li>écrire (remplacer) / append (écrit à la fin)</li>
<li>changer des méta-datas</li>
</ul>
<p>Opérations que l'on peut faire sur les dossiers, selon les permissions :</p>
<ul>
<li>créer / supprimer : dépend des droits du dossier parent</li>
<li>ouvrir / fermer</li>
<li>lire</li>
<li>changer des méta-datas</li>
</ul>
<p>Le système doit connaître tous les fichiers utilisés. C'est une liste où chaque entrée est un <a href="https://en.wikipedia.org/wiki/File_descriptor">descripteur de fichier</a> qui contient :</p>
<ul>
<li>quel fichier est concerné</li>
<li>type d'accès lecture, écriture, etc.</li>
<li>le nombre de threads qui utilisent cette entrée</li>
<li>la position dans le fichier</li>
</ul>
<p>Un même fichier peut apparaître plusieurs fois, mais si c'est deux accès en écriture, ou un accès en lecture et un autre en écriture, il peut se passer des choses bizarres. Ouvrir un fichier en écriture commençant par créer un nouveau fichier.</p>
<p>Plusieurs thread peuvent se partager la même entrée.</p>
<h2>Journalisation</h2>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-emerald-500 bg-emerald-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-emerald-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path>
</svg>
<div class="pl-8 mr-8">
<p><a href="https://en.wikipedia.org/wiki/Journaling_file_system">https://en.wikipedia.org/wiki/Journaling_file_system</a></p>
</div></div>

<p>Stocker ses données sur le disque est ue opération courante mais intrinsèquement dangereuse, la moindre erreur peut invalider des données ce qui peut se révéler catastrophique.</p>
<p>Des mécanisme de <a href="https://fr.wikipedia.org/wiki/Journal_(syst%C3%A8me_de_fichiers)">journalisation</a> sont présent dans tous les systèmes de fichiers utilisés pour des ordinateurs de bureau ou serveurs. Ils permettent de ne pas perdre de données en cas de crash système.</p>
<p>Ils fonctionnent de la même manière :</p>
<ol>
<li>ils regroupent les opérations effectuées sur le disque en <a href="https://en.wikipedia.org/wiki/Transaction_processing">transaction</a> : une suite d'opérations de lecture/écriture à faire séquentiellement et sans interruption</li>
<li>la transaction n'est effectuée que si elle est au préalable sauvée sur le disque dur</li>
</ol>
<p>Ceci nécessite un espace dédié sur le disque dur où les transactions sont stockées. Comme la suite de transactions à effectuer est séquentielle, l'espace de stockage est une liste circulaire.</p>
<p>Chaque transaction est un intervalle de cette liste comprenant un bloc de départ, une suite de blocs d'opérations à effectuer, un bloc de fin. Une fois le bloc de fin écrit dans la liste, la transaction est considérée comme terminée et peut être effectuée sur le système.</p>
<p>Liste circulaire :</p>
<pre><code>init A |  opération 1 | opération 2 | ... | opération n | bloc fin A | init B | ...

</code></pre>
<p>Si un crash intervient au milieu de la transaction, elle peut être intégralement rejouée pour être complétée.</p>
<h2>Formats</h2>
<p>Cette organisation logique d'un système de fichier cache une grande variété d'implémentations possibles pour stocker effectivement les données sur un disque dur.</p>
<p>Cette structure n'est pas gratuite et prend couramment plus de $1\%$ de la taille totale du disque.</p>
<p>De plus, la nécessaire rétro-compatibilité des systèmes les rend souvent difficile à comprendre.</p>
<h3>Formats courants</h3>
<p>Tous les formats sont contraints par la structure d'un disque dur qui lit ses données par page (pour les vieux disques dur non SSD, on parle de secteur) qui est habituellement de 4KiB. Traditionnellement, la taille d'un bloc est de 512B (c'est parfois cette valeur qui est rendue par un disque <a href="https://wiki.archlinux.org/title/Advanced_Format#NVMe_solid_state_drives">même si en interne la taille est plus importante</a>), c'est pourquoi nombre de format découpent leurs structures en paquets de 512B.</p>
<p>Nous allons étudier plus avant 2 grandes structures, utilisées couramment :</p>
<ul>
<li>format FAT : utilisées pour les partitions de boot et les disques USB</li>
<li>format extfs : format Linux</li>
</ul>
<p>Ces formats stockent dans le même espace les données (les fichiers) et l'organisation hiérarchique du système (les dossiers). Leurs deux approches diffèrent peu (l'un a une structure linéaire, l'autre arborée), mais cela suffit à les rendre très différent à l'usage.</p>
<h3>Format FAT</h3>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-fuchsia-500 bg-fuchsia-100">
  <svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-fuchsia-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z"></path>
  </svg>
<div class="pl-8 mr-8">
<p><a href="FAT" class="interne">Format FAT</a></p>
</div></div>

<h3>Format ext4</h3>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-fuchsia-500 bg-fuchsia-100">
  <svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-fuchsia-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z"></path>
  </svg>
<div class="pl-8 mr-8">
<p><a href="ext" class="interne">Format ext4</a></p>
</div></div>

<h3>Autres formats</h3>
<ul>
<li><a href="https://en.wikipedia.org/wiki/NTFS">NTFS</a> (windows)</li>
<li><a href="https://fr.wikipedia.org/wiki/ZFS">zfs</a> (l'avenir au présent)</li>
</ul>


</article>
    </main>

    <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
      <div class="max-w-[1200px] mx-auto px-4 relative">
        <div class="min-h-[50px] flex justify-center items-center">
          <p>
            Cours d'informatique de François Brucker
          </p>
        </div>
        <div class="min-h-[50px] flex justify-center items-center absolute right-0 top-0">
          <button onclick="goTop()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 11.25l-3-3m0 0l-3 3m3-3v7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>

          <button onclick="goBottom()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75l3 3m0 0l3-3m-3 3v-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>
        </div>

      </div>
    </footer>

    <script>
      MathJax
        .startup
        .document
        .getMathItemsWithin(document.body);
    </script>

  </body>
</html>